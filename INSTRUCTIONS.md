# CineFoyer 4DX — Полная Документация Проекта

## 1. Описание Проекта

**CineFoyer 4DX** — это профессиональная система цифровых киноафиш (Digital Signage), разработанная специально для фойе многозальных кинотеатров. Приложение превращает обычные телевизоры или мониторы в динамические рекламные поверхности.

### Ключевые возможности:
*   **Мультиэкранность:** Поддержка управления контентом для 4-х (и более) независимых зон/экранов.
*   **Автоматизация расписания:** Загрузка "сырых" данных из Excel (CSV/TXT) и их автоматическая привязка к экранам.
*   **AI-обогащение (Gemini):** Автоматический поиск описаний, режиссеров и генерация метаданных, если их нет в файле.
*   **Интеграция с Кинопоиском:** Поиск официальных постеров и рейтингов.
*   **Ротация контента:** Автоматическое переключение слайдов (постер фильма -> расписание сеансов) с настраиваемым интервалом.
*   **Кастомизация:** Полная настройка цветов бренда, фоновых изображений и ориентации экранов (горизонтальная/вертикальная).
*   **Автономность:** Использование локальной базы данных (SQLite) гарантирует работу даже при нестабильном интернете.

---

## 2. Архитектура и Технологический Стек

Проект построен как монолитное приложение, объединяющее Frontend и Backend для простоты развертывания.

*   **Frontend:** React 18, Vite, Tailwind CSS, Lucide React (иконки).
*   **Backend:** Node.js, Express.
*   **База Данных:** SQLite (файловая БД, не требует установки сервера БД).
*   **ORM:** Prisma (для управления базой данных).
*   **Контейнеризация:** Docker & Docker Compose.
*   **Внешние API:** Google Gemini (AI), Kinopoisk (Unofficial).

---

## 3. План Сборки "С Нуля" (Zero to Hero)

Следуйте этой инструкции, чтобы запустить проект на чистом компьютере.

### Шаг 1: Подготовка окружения
Вам понадобятся:
1.  **Node.js** (версия 18 или 20). [Скачать](https://nodejs.org/)
2.  **Git** (для скачивания кода).
3.  **Редактор кода** (VS Code).

### Шаг 2: Создание структуры файлов
Если вы копируете код вручную, создайте следующую структуру папок:

```text
/cinefoyer-app
  ├── /components       (Frontend компоненты: AdminPanel, FoyerDisplay, etc.)
  ├── /services         (API сервисы: api.ts, geminiService.ts, kinopoiskService.ts)
  ├── /prisma           (Конфигурация БД: schema.prisma)
  ├── App.tsx           (Главный компонент)
  ├── index.html        (Точка входа HTML)
  ├── index.tsx         (Точка входа React)
  ├── server.js         (Backend сервер)
  ├── package.json      (Зависимости)
  ├── vite.config.ts    (Настройки сборщика)
  ├── types.ts          (TypeScript типы)
  ├── Dockerfile        (Инструкция для Docker)
  └── docker-compose.yml (Запуск Docker)
```

### Шаг 3: Установка зависимостей
Откройте терминал в папке проекта и выполните:

```bash
npm install
```
*Эта команда скачает все библиотеки, указанные в package.json.*

### Шаг 4: Настройка Базы Данных (Prisma + SQLite)
1.  Создайте файл `.env` в корне проекта (рядом с package.json):
    ```env
    DATABASE_URL="file:./dev.db"
    ```
2.  Сгенерируйте клиент базы данных и саму базу:
    ```bash
    npx prisma generate
    npx prisma db push
    ```
*После этого появится папка `prisma` (если её не было) и файл `dev.db`.*

### Шаг 5: Запуск в режиме разработки
Для разработки нам нужно два процесса: один собирает интерфейс, второй обслуживает API.

1.  **Терминал 1 (Сервер):**
    ```bash
    npm run server
    ```
2.  **Терминал 2 (Интерфейс):**
    ```bash
    npm run dev
    ```
3.  Откройте ссылку из второго терминала (обычно `http://localhost:5173`).

### Шаг 6: Сборка для продакшена (Docker)
Это финальный этап для установки на компьютер в кинотеатре.

1.  Установите **Docker Desktop**.
2.  В корне проекта выполните:
    ```bash
    docker-compose up -d --build
    ```
3.  Приложение будет доступно по адресу `http://localhost:3000`.
4.  База данных будет сохранена в Docker Volume, данные не пропадут при перезагрузке.

---

## 4. Работа с Приложением

1.  **Регистрация:** При первом запуске введите название кинотеатра и API ключи.
    *   *Совет:* Если нет ключей, нажмите кнопку "Демо" в правом углу.
2.  **Админка:**
    *   Вкладка "Контент": Добавляйте фильмы через поиск (Кинопоиск) или загружайте расписание файлом.
    *   Вкладка "Настройки": Меняйте цвета, фон, количество экранов и их ориентацию.
3.  **Запуск:** Нажмите "Запуск Афиши". Для выхода из полноэкранного режима наведите мышь на верхнюю грань экрана и нажмите кнопку "Выход".

## 5. Решение проблем

*   **Ошибка `Prisma Client not initialized`:** Выполните `npx prisma generate`.
*   **Нет картинок:** Проверьте подключение к интернету (картинки грузятся по URL).
*   **Docker не запускается:** Убедитесь, что порт 3000 свободен.
